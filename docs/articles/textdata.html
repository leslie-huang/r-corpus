<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Text data in Corpus and other packages â€¢ corpus</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Text data in Corpus and other packages">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-4636081-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-4636081-3');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">corpus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/corpus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/chinese.html">Chinese text handling</a>
    </li>
    <li>
      <a href="../articles/gender.html">Finding gendered words</a>
    </li>
    <li>
      <a href="../articles/stemmer.html">Stemming Words</a>
    </li>
    <li>
      <a href="../articles/textdata.html">Text data in Corpus and other packages</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/leslie-huang/r-corpus">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Text data in Corpus and other packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leslie-huang/r-corpus/blob/master/vignettes/textdata.Rmd"><code>vignettes/textdata.Rmd</code></a></small>
      <div class="hidden name"><code>textdata.Rmd</code></div>

    </div>

    
    
<div id="text-data-type" class="section level2">
<h2 class="hasAnchor">
<a href="#text-data-type" class="anchor"></a>Text data type</h2>
<p>The <em>corpus</em> package does not define a special corpus object, but it does define a new data type, <code>corpus_text</code>, for storing a collection of texts. You can create values of this type using the <code><a href="../reference/corpus_text.html">as_corpus_text()</a></code> or <code><a href="../reference/corpus_frame.html">as_corpus_frame()</a></code> function.</p>
<p>Take, for example, the following sample text, created as an R character vector.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># raw text for the first two paragraphs of _The Tale of Peter Rabbit_,</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># by Beatrix Potter</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>raw &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="dt">para1 =</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>        <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Once upon a time there were four little Rabbits,"</span>,</span>
<span id="cb1-6"><a href="#cb1-6"></a>              <span class="st">"and their names were: Flopsy, Mopsy, Cottontail, and Peter."</span>,</span>
<span id="cb1-7"><a href="#cb1-7"></a>              <span class="st">"They lived with their Mother in a sandbank,"</span>,</span>
<span id="cb1-8"><a href="#cb1-8"></a>              <span class="st">"underneath the root of a very big fir tree."</span>,</span>
<span id="cb1-9"><a href="#cb1-9"></a>              <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>),</span>
<span id="cb1-10"><a href="#cb1-10"></a>    <span class="dt">para2 =</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>        <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"'Now, my dears,' said old Mrs. Rabbit one morning,"</span>,</span>
<span id="cb1-12"><a href="#cb1-12"></a>              <span class="st">"'you may go into the fields or down the lane,"</span>,</span>
<span id="cb1-13"><a href="#cb1-13"></a>              <span class="st">"but don't go into Mr. McGregor's garden --"</span>,</span>
<span id="cb1-14"><a href="#cb1-14"></a>              <span class="st">"your Father had an accident there;"</span>,</span>
<span id="cb1-15"><a href="#cb1-15"></a>              <span class="st">"he was put in a pie by Mrs. McGregor.'"</span>,</span>
<span id="cb1-16"><a href="#cb1-16"></a>              <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span></code></pre></div>
<p>We can convert the text to a <code>corpus_text</code> object using the <code><a href="../reference/corpus_text.html">as_corpus_text()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>text &lt;-<span class="st"> </span><span class="kw"><a href="../reference/corpus_text.html">as_corpus_text</a></span>(raw)</span></code></pre></div>
<p>Alternatively, we can convert it to a data frame with a column named <code>"text"</code> of type <code>corpus_text</code> using the <code><a href="../reference/corpus_frame.html">as_corpus_frame()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/corpus_frame.html">as_corpus_frame</a></span>(raw)</span></code></pre></div>
<p>Both <code><a href="../reference/corpus_frame.html">as_corpus_frame()</a></code> and <code><a href="../reference/corpus_text.html">as_corpus_text()</a></code> are generic; they work on character vectors, data frames, <em>tm</em> <code>Corpus</code> objects, and <em>quanteda</em> <code>corpus</code> objects. Whenever you call a <em>corpus</em> function expecting text, that function calls <code><a href="../reference/corpus_text.html">as_corpus_text()</a></code> on its input. We will see some examples of converting <em>tm</em> and <em>quanteda</em> objects below.</p>
<p>The <code>corpus_text</code> type behaves like an R character vector in most respects, but using this type enables some new features.</p>
</div>
<div id="text-filter" class="section level2">
<h2 class="hasAnchor">
<a href="#text-filter" class="anchor"></a>Text filter</h2>
<p>Each <code>corpus_text</code> object has a <code>text_filter</code> property that can be get or set using the <code><a href="../reference/text_filter.html">text_filter()</a></code> generic function. This property allows us to specify the preprocessing decisions that define the text normalization, token, and sentence boundaries.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># get the text filter</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="../reference/text_filter.html">text_filter</a></span>(text))</span></code></pre></div>
<pre><code>Text filter with the following options:

    map_case: TRUE
    map_quote: TRUE
    remove_ignorable: TRUE
    combine: NULL
    stemmer: NULL
    stem_dropped: FALSE
    stem_except: NULL
    drop_letter: FALSE
    drop_number: FALSE
    drop_punct: FALSE
    drop_symbol: FALSE
    drop: NULL
    drop_except: NULL
    connector: _
    sent_crlf: FALSE
    sent_suppress:  chr [1:155] "A." "A.D." "a.m." "A.M." "A.S." "AA." "AB." "Abs." "AD." ...</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># set a new text filter</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw"><a href="../reference/text_filter.html">text_filter</a></span>(text) &lt;-<span class="st"> </span><span class="kw"><a href="../reference/text_filter.html">text_filter</a></span>(<span class="dt">drop_punct =</span> <span class="ot">TRUE</span>, <span class="dt">drop =</span> stopwords_en)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># update a text filter property</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw"><a href="../reference/text_filter.html">text_filter</a></span>(text)<span class="op">$</span>drop_punct &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co"># switch to the default text filter</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw"><a href="../reference/text_filter.html">text_filter</a></span>(text) &lt;-<span class="st"> </span><span class="ot">NULL</span></span></code></pre></div>
</div>
<div id="valid-utf-8" class="section level2">
<h2 class="hasAnchor">
<a href="#valid-utf-8" class="anchor"></a>Valid UTF-8</h2>
<p>All <code>corpus_text</code> objects contain valid UTF-8 data. It is impossible to create a <code>corpus_text</code> object with invalid UTF-8:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># the input is encoded in Latin-1, but declared as UTF-8</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>x &lt;-<span class="st"> "fa</span><span class="ch">\xE7</span><span class="st">ile"</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Encoding.html">Encoding</a></span>(x) &lt;-<span class="st"> "UTF-8"</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="kw"><a href="../reference/corpus_text.html">as_corpus_text</a></span>(x) <span class="co">## fails</span></span></code></pre></div>
<pre><code>Error in as_corpus_text.character(x): argument entry 1 is incorrectly marked as "UTF-8": leading byte 0xE7 followed by invalid continuation byte (0x69) at position 4</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="../reference/corpus_text.html">as_corpus_text</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/iconv.html">iconv</a></span>(x, <span class="st">"Latin1"</span>, <span class="st">"UTF-8"</span>)) <span class="co">## succeeds</span></span></code></pre></div>
<pre><code>[1] "faÃ§ile"</code></pre>
</div>
<div id="unique-names" class="section level2">
<h2 class="hasAnchor">
<a href="#unique-names" class="anchor"></a>Unique names</h2>
<p>All <code>corpus_text</code> objects have unique names. When you coerce an object with duplicate names to <code>corpus_text</code>, the duplicates get renamed with a warning:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/corpus_text.html">as_corpus_text</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">a =</span> <span class="st">"hello"</span>, <span class="dt">b =</span> <span class="st">"world"</span>, <span class="dt">a =</span> <span class="st">"repeated name"</span>)) <span class="co"># fails</span></span></code></pre></div>
<pre><code>Warning in as_corpus_text.character(c(a = "hello", b = "world", a = "repeated name")): renaming
entries with duplicate names</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(x)</span></code></pre></div>
<pre><code>[1] "a"   "b"   "a.1"</code></pre>
<p>Setting repeated names fails:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># fails, duplicate names</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(x) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>)</span></code></pre></div>
<pre><code>Error in `names&lt;-.corpus_text`(`*tmp*`, value = c("a", "b", "a")): duplicate 'names' are not allowed</code></pre>
<p>You can set the <code>names</code> to <code>NULL</code> if you donâ€™t want them:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(x) &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(x))</span></code></pre></div>
<pre><code>NULL</code></pre>
</div>
<div id="reference-memory-mapped-data" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-memory-mapped-data" class="anchor"></a>Reference memory-mapped data</h2>
<p><code>corpus_text</code> objects can manage collections of texts that do not fit into memory, through the memory-map interface provided by <code><a href="../reference/read_ndjson.html">read_ndjson()</a></code>. When dealing with such objects, internally the <code>corpus_text</code> object just stores an offset into the file containing the text, not the text itself.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># store some sample data in a newline-delimited JSON file</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>tmp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>()</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="kw"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'{"text": "A sample text", "metadata": 7 }'</span>,</span>
<span id="cb19-4"><a href="#cb19-4"></a>             <span class="st">'{"text": "Another text."}'</span>,</span>
<span id="cb19-5"><a href="#cb19-5"></a>             <span class="st">'{"text": "A third text.", "metadata": -100}'</span>),</span>
<span id="cb19-6"><a href="#cb19-6"></a>           tmp)</span>
<span id="cb19-7"><a href="#cb19-7"></a></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co"># memory-map the "text" field</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_ndjson.html">read_ndjson</a></span>(tmp, <span class="dt">text =</span> <span class="st">"text"</span>, <span class="dt">mmap =</span> <span class="ot">TRUE</span>)</span>
<span id="cb19-10"><a href="#cb19-10"></a></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co"># display the internal representation of the resulting 'corpus_text' object</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="kw"><a href="https://rdrr.io/r/base/class.html">unclass</a></span>(data<span class="op">$</span>text)</span></code></pre></div>
<pre><code>$handle
&lt;pointer: 0x7fba65dd4ba0&gt;

$sources
$sources[[1]]
JSON data set with 3 rows of type text


$table
  source row start stop
1      1   1     1   13
2      1   2     1   13
3      1   3     1   13

$names
NULL

$filter
NULL</code></pre>
<p>Above, the <code>handle</code> component of the text object is a memory-mapped view of the file. The <code>table</code> component stores the row numbers for the data, along with the start and stop indices of the text.</p>
</div>
<div id="reference-substrings-of-other-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-substrings-of-other-objects" class="anchor"></a>Reference substrings of other objects</h2>
<p><code>corpus_text</code> objects can reference substrings of other R character objects, without copying the parent object. This allows functions like <code><a href="../reference/text_split.html">text_split()</a></code> and <code><a href="../reference/text_locate.html">text_locate()</a></code> to quickly split a text into smaller segments without allocating new character strings.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># segment text into chunks of at most 10 tokens</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>(chunks &lt;-<span class="st"> </span><span class="kw"><a href="../reference/text_split.html">text_split</a></span>(text, <span class="st">"tokens"</span>, <span class="dv">10</span>))</span></code></pre></div>
<pre><code>   parent index text                                           
1  para1      1 Once upon a time there were four little Rabbits
2  para1      2 ,\nand their names were: Flopsy, Mopsy         
3  para1      3 , Cottontail, and Peter.\nThey lived with      
4  para1      4 their Mother in a sandbank,\nunderneath the    
5  para1      5 root of a very big fir tree.                   
6  para2      1 'Now, my dears,' said old Mrs                  
7  para2      2 . Rabbit one morning,\n'you may go into        
8  para2      3 the fields or down the lane,\nbut don't        
9  para2      4 go into Mr. McGregor's garden --\nyour         
10 para2      5 Father had an accident there;\nhe was put      
11 para2      6 in a pie by Mrs. McGregor.'                    </code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># segmenting does not allocate new objects for the segments</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw"><a href="https://rdrr.io/r/base/class.html">unclass</a></span>(chunks<span class="op">$</span>text) <span class="co"># inspect text internals</span></span></code></pre></div>
<pre><code>$handle
&lt;pointer: 0x7fba65fa0fb0&gt;

$sources
$sources[[1]]
                                                                                                                                                                                                                      para1 
                  "Once upon a time there were four little Rabbits,\nand their names were: Flopsy, Mopsy, Cottontail, and Peter.\nThey lived with their Mother in a sandbank,\nunderneath the root of a very big fir tree." 
                                                                                                                                                                                                                      para2 
"'Now, my dears,' said old Mrs. Rabbit one morning,\n'you may go into the fields or down the lane,\nbut don't go into Mr. McGregor's garden --\nyour Father had an accident there;\nhe was put in a pie by Mrs. McGregor.'" 


$table
   source row start stop
1       1   1     1   47
2       1   1    48   84
3       1   1    85  125
4       1   1   126  168
5       1   1   169  196
6       1   2     1   29
7       1   2    30   68
8       1   2    69  107
9       1   2   108  145
10      1   2   146  186
11      1   2   187  213

$names
NULL

$filter
NULL</code></pre>
<p>The call to <code><a href="../reference/text_split.html">text_split()</a></code> did not allocate any new character objects; the result uses the same sources, but with different start and stop indices.</p>
</div>
<div id="better-printing" class="section level2">
<h2 class="hasAnchor">
<a href="#better-printing" class="anchor"></a>Better printing</h2>
<p>Printing <code>corpus_text</code> objects truncates the output at the end of the line instead of printing the entire contents.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># print a character object</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(raw)</span></code></pre></div>
<pre><code>                                                                                                                                                                                                                      para1 
                  "Once upon a time there were four little Rabbits,\nand their names were: Flopsy, Mopsy, Cottontail, and Peter.\nThey lived with their Mother in a sandbank,\nunderneath the root of a very big fir tree." 
                                                                                                                                                                                                                      para2 
"'Now, my dears,' said old Mrs. Rabbit one morning,\n'you may go into the fields or down the lane,\nbut don't go into Mr. McGregor's garden --\nyour Father had an accident there;\nhe was put in a pie by Mrs. McGregor.'" </code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># print a corpus_text object</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(text)</span></code></pre></div>
<pre><code>para1                                                                                          
"Once upon a time there were four little Rabbits,\nand their names were: Flopsy, Mopsy, Cottoâ€¦"
para2                                                                                          
"'Now, my dears,' said old Mrs. Rabbit one morning,\n'you may go into the fields or down the â€¦"</code></pre>
<p>If youâ€™d like to print the entire contents, you can convert the text to character and then print:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># print entire contents</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(text))</span></code></pre></div>
<pre><code>[1] "Once upon a time there were four little Rabbits,\nand their names were: Flopsy, Mopsy, Cottontail, and Peter.\nThey lived with their Mother in a sandbank,\nunderneath the root of a very big fir tree."                  
[2] "'Now, my dears,' said old Mrs. Rabbit one morning,\n'you may go into the fields or down the lane,\nbut don't go into Mr. McGregor's garden --\nyour Father had an accident there;\nhe was put in a pie by Mrs. McGregor.'"</code></pre>
</div>
<div id="conversion-to-character" class="section level2">
<h2 class="hasAnchor">
<a href="#conversion-to-character" class="anchor"></a>Conversion to character</h2>
<p>The one disadvantage of using a <code>corpus_text</code> object instead of an R character vector is that many functions from other packages that expect R character vectors will not work on <code>corpus_text</code>. To get around this, you can call <code>as.character</code> on a <code>corpus_text</code> object to convert it to an R character vector.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># some R methods coerce their inputs to character; 'message' is one example</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="kw"><a href="../reference/corpus_text.html">as_corpus_text</a></span>(<span class="st">"hello world"</span>))</span></code></pre></div>
<pre><code>hello world</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># others do not;</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw"><a href="../reference/corpus_text.html">as_corpus_text</a></span>(<span class="st">"hello world"</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>) <span class="co"># fails</span></span></code></pre></div>
<pre><code>Error in cat(as_corpus_text("hello world"), "\n"): argument 1 (type 'list') cannot be handled by 'cat'</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># we must call 'as.character' on the inputs</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="../reference/corpus_text.html">as_corpus_text</a></span>(<span class="st">"hello world"</span>)), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code></pre></div>
<pre><code>hello world </code></pre>
</div>
<div id="interface-with-quanteda" class="section level2">
<h2 class="hasAnchor">
<a href="#interface-with-quanteda" class="anchor"></a>Interface with <em>quanteda</em>
</h2>
<p>All <em>corpus</em> functions expecting text work on <em>quanteda</em> corpus objects:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>uk2010immigCorpus &lt;-<span class="st"> </span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="st">    </span>quanteda<span class="op">::</span><span class="kw"><a href="https://quanteda.io/reference/corpus.html">corpus</a></span>(quanteda<span class="op">::</span>data_char_ukimmig2010,</span>
<span id="cb37-3"><a href="#cb37-3"></a>           <span class="dt">docvars =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">party =</span> <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(quanteda<span class="op">::</span>data_char_ukimmig2010)),</span>
<span id="cb37-4"><a href="#cb37-4"></a>           <span class="dt">metacorpus =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">notes =</span> <span class="st">"Immigration-related sections of 2010 UK party manifestos"</span>))</span>
<span id="cb37-5"><a href="#cb37-5"></a></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co"># search for terms in a quanteda corpus that stem to "immigr":</span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="kw"><a href="../reference/text_locate.html">text_locate</a></span>(uk2010immigCorpus, <span class="st">"immigr"</span>, <span class="dt">stemmer =</span> <span class="st">"en"</span>)</span></code></pre></div>
<pre><code>   text                before                  instance                   after                
1  BNP                                        IMMIGRATION : AN UNPARALLELED CRISIS WHICH ONLY â€¦
2  BNP  â€¦THE BNP CAN SOLVE. \n\n- At current  immigration  and birth rates, indigenous Britishâ€¦
3  BNP  â€¦ will include a halt to all further  immigration , the deportation of all illegal immâ€¦
4  BNP  â€¦ion, the deportation of all illegal  immigrants  , a halt to the "asylum" swindle andâ€¦
5  BNP  â€¦mes in Britain, regardless of their  immigration  status.\n\n- The BNP will review alâ€¦
6  BNP  â€¦mission that they orchestrated mass  immigration  to change forcibly Britain's demogrâ€¦
7  BNP  â€¦ce is in grave peril, threatened by  immigration  and multiculturalism. In the absencâ€¦
8  BNP  â€¦Statistics (ONS), legal Third World  immigrants   made up 14.7 percent (7.5 million) â€¦
9  BNP  â€¦rths to second and third generation   immigrant   mothers. Figures released by the ONâ€¦
10 BNP  â€¦hen these figures are added in, the   immigrant   birth rate is estimated to be arounâ€¦
11 BNP  â€¦ales.\n\n- The majority of the 'new  immigrants  ' are not from Eastern Europe, as isâ€¦
12 BNP  â€¦imed. According to the ONS figures,  immigrants   from Eastern Europe had 25,000 chilâ€¦
13 BNP  â€¦er exponentially, and given current  immigration  and birth rates, will utterly overwâ€¦
14 BNP  â€¦s.\n\nThe Disastrous Effect of Mass  Immigration  on British Society\n\nThere is no eâ€¦
15 BNP  â€¦here that it is 'racist' to discuss  immigration  and population density.\n\nThe wordâ€¦
16 BNP  â€¦between 300,000-500,000 Third World  immigrants   each year is an issue that all threâ€¦
17 BNP  â€¦d so on.\n\nA Case Study: Crime and  Immigration \n\nImmigration has had a dramatic eâ€¦
18 BNP  â€¦ase Study: Crime and Immigration\n\n Immigration  has had a dramatic effect on Britaiâ€¦
19 BNP  â€¦onately involving ethnic groups.\n\n Immigration  Has Harmed British Jobs\n\nThe concâ€¦
20 BNP  â€¦s working than in 1997.\n\nOverall,  immigrants   have taken up more than 1.64 millioâ€¦
â‹®  (87 rows total)</code></pre>
<p>You can convert a <em>quanteda</em> corpus to a data frame using <code><a href="../reference/corpus_frame.html">as_corpus_frame()</a></code>, or extract its text using <code><a href="../reference/corpus_text.html">as_corpus_text()</a></code>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># convert to corpus_text:</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="../reference/corpus_text.html">as_corpus_text</a></span>(uk2010immigCorpus))</span></code></pre></div>
<pre><code>BNP                                                                                            
"IMMIGRATION: AN UNPARALLELED CRISIS WHICH ONLY THE BNP CAN SOLVE. \n\n- At current immigratiâ€¦"
Coalition                                                                                      
"IMMIGRATION. \n\nThe Government believes that immigration has enriched our culture and strenâ€¦"
Conservative                                                                                   
"Attract the brightest and best to our country.\n\nImmigration has enriched our nation over tâ€¦"
Greens                                                                                         
"Immigration.\n\nMigration is a fact of life.  People have always moved from one country to aâ€¦"
Labour                                                                                         
"Crime and immigration\n\nThe challenge for Britain\n\nWe will control immigration with our nâ€¦"
LibDem                                                                                         
"firm but fair immigration system\n\nBritain has always been an open, welcoming country, and â€¦"
PC                                                                                             
"As a welcoming nation, Plaid Cymru recognises the invaluable contribution that migrants haveâ€¦"
SNP                                                                                            
"And we will argue for Scotland to take responsibility for immigration so that we can developâ€¦"
UKIP                                                                                           
"Immigration &amp; Asylum.\n\nAs a member of the EU, Britain has lost control of her borders. Somâ€¦"</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># convert to data frame:</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="../reference/corpus_frame.html">as_corpus_frame</a></span>(uk2010immigCorpus))</span></code></pre></div>
<pre><code>             party        text                                                                 
BNP          BNP          IMMIGRATION: AN UNPARALLELED CRISIS WHICH ONLY THE BNP CAN SOLVE. \nâ€¦
Coalition    Coalition    IMMIGRATION. \n\nThe Government believes that immigration has enrichâ€¦
Conservative Conservative Attract the brightest and best to our country.\n\nImmigration has enâ€¦
Greens       Greens       Immigration.\n\nMigration is a fact of life.  People have always movâ€¦
Labour       Labour       Crime and immigration\n\nThe challenge for Britain\n\nWe will controâ€¦
LibDem       LibDem       firm but fair immigration system\n\nBritain has always been an open,â€¦
PC           PC           As a welcoming nation, Plaid Cymru recognises the invaluable contribâ€¦
SNP          SNP          And we will argue for Scotland to take responsibility for immigratioâ€¦
UKIP         UKIP         Immigration &amp; Asylum.\n\nAs a member of the EU, Britain has lost conâ€¦</code></pre>
</div>
<div id="interface-with-tm" class="section level2">
<h2 class="hasAnchor">
<a href="#interface-with-tm" class="anchor"></a>Interface with <em>tm</em>
</h2>
<p>All <em>corpus</em> functions expecting text also work on <em>tm</em> Corpus objects:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"crude"</span>, <span class="dt">package =</span> <span class="st">"tm"</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="co"># get the top terms in a tm corpus:</span></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="kw"><a href="../reference/term_stats.html">term_stats</a></span>(crude, <span class="dt">drop_punct =</span> <span class="ot">TRUE</span>, <span class="dt">drop =</span> stopwords_en)</span></code></pre></div>
<pre><code>   term      count support
1  oil          85      20
2  said         73      20
3  reuter       20      20
4  prices       48      15
5  last         24      12
6  one          17      12
7  dlrs         23      11
8  opec         44      10
9  barrel       15      10
10 mln          31       9
11 crude        21       9
12 new          14       9
13 pct          14       9
14 price        13       9
15 also          9       9
16 petroleum     9       9
17 market       20       8
18 barrels      11       8
19 industry     10       8
20 world        10       8
â‹®  (1042 rows total)</code></pre>
<p>The <code><a href="../reference/corpus_frame.html">as_corpus_frame()</a></code> and <code><a href="../reference/corpus_text.html">as_corpus_text()</a></code> functions also work on <em>tm</em> Corpus objects:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># convert to corpus_text</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="../reference/corpus_text.html">as_corpus_text</a></span>(crude))</span></code></pre></div>
<pre><code>127                                                                                            
"Diamond Shamrock Corp said that\neffective today it had cut its contract prices for crude oiâ€¦"
144                                                                                            
"OPEC may be forced to meet before a\nscheduled June session to readdress its production cuttâ€¦"
191                                                                                            
"Texaco Canada said it lowered the\ncontract price it will pay for crude oil 64 Canadian cts â€¦"
194                                                                                            
"Marathon Petroleum Co said it reduced\nthe contract price it will pay for all grades of crudâ€¦"
211                                                                                            
"Houston Oil Trust said that independent\npetroleum engineers completed an annual study that â€¦"
236                                                                                            
"Kuwait\"s Oil Minister, in remarks\npublished today, said there were no plans for an emergenâ€¦"
237                                                                                            
"Indonesia appears to be nearing a\npolitical crossroads over measures to deregulate its protâ€¦"
242                                                                                            
"Saudi riyal interbank deposits were\nsteady at yesterday's higher levels in a quiet market.â€¦" 
246                                                                                            
"The Gulf oil state of Qatar, recovering\nslightly from last year's decline in world oil pricâ€¦"
248                                                                                            
"Saudi Arabian Oil Minister Hisham Nazer\nreiterated the kingdom's commitment to last Decembeâ€¦"
273                                                                                            
"Saudi crude oil output last month fell\nto an average of 3.5 mln barrels per day (bpd) from â€¦"
349                                                                                            
"Deputy oil ministers from six Gulf\nArab states will meet in Bahrain today to discuss coordiâ€¦"
352                                                                                            
"Saudi Arabian Oil Minister Hisham Nazer\nreiterated the kingdom's commitment to last Decembeâ€¦"
353                                                                                            
"Kuwait's oil minister said in a newspaper\ninterview that there were no plans for an emergenâ€¦"
368                                                                                            
"The port of Philadelphia was closed\nwhen a Cypriot oil tanker, Seapride II, ran aground aftâ€¦"
489                                                                                            
"A study group said the United States\nshould increase its strategic petroleum reserve to oneâ€¦"
502                                                                                            
"A study group said the United States\nshould increase its strategic petroleum reserve to oneâ€¦"
543                                                                                            
"Unocal Corp's Union Oil Co said it\nlowered its posted prices for crude oil one to 1.50 dlrsâ€¦"
704                                                                                            
"The New York Mercantile Exchange set\nApril one for the debut of a new procedure in the enerâ€¦"
708                                                                                            
"Argentine crude oil production was\ndown 10.8 pct in January 1987 to 12.32 mln barrels, fromâ€¦"</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># convert to data frame</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="../reference/corpus_frame.html">as_corpus_frame</a></span>(crude))</span></code></pre></div>
<pre><code>    text                                                                                       
127 Diamond Shamrock Corp said that\neffective today it had cut its contract prices for crude â€¦
144 OPEC may be forced to meet before a\nscheduled June session to readdress its production cuâ€¦
191 Texaco Canada said it lowered the\ncontract price it will pay for crude oil 64 Canadian ctâ€¦
194 Marathon Petroleum Co said it reduced\nthe contract price it will pay for all grades of crâ€¦
211 Houston Oil Trust said that independent\npetroleum engineers completed an annual study thaâ€¦
236 Kuwait"s Oil Minister, in remarks\npublished today, said there were no plans for an emergeâ€¦
237 Indonesia appears to be nearing a\npolitical crossroads over measures to deregulate its prâ€¦
242 Saudi riyal interbank deposits were\nsteady at yesterday's higher levels in a quiet marketâ€¦
246 The Gulf oil state of Qatar, recovering\nslightly from last year's decline in world oil prâ€¦
248 Saudi Arabian Oil Minister Hisham Nazer\nreiterated the kingdom's commitment to last Decemâ€¦
273 Saudi crude oil output last month fell\nto an average of 3.5 mln barrels per day (bpd) froâ€¦
349 Deputy oil ministers from six Gulf\nArab states will meet in Bahrain today to discuss coorâ€¦
352 Saudi Arabian Oil Minister Hisham Nazer\nreiterated the kingdom's commitment to last Decemâ€¦
353 Kuwait's oil minister said in a newspaper\ninterview that there were no plans for an emergâ€¦
368 The port of Philadelphia was closed\nwhen a Cypriot oil tanker, Seapride II, ran aground aâ€¦
489 A study group said the United States\nshould increase its strategic petroleum reserve to oâ€¦
502 A study group said the United States\nshould increase its strategic petroleum reserve to oâ€¦
543 Unocal Corp's Union Oil Co said it\nlowered its posted prices for crude oil one to 1.50 dlâ€¦
704 The New York Mercantile Exchange set\nApril one for the debut of a new procedure in the enâ€¦
708 Argentine crude oil production was\ndown 10.8 pct in January 1987 to 12.32 mln barrels, frâ€¦</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#text-data-type">Text data type</a></li>
      <li><a href="#text-filter">Text filter</a></li>
      <li><a href="#valid-utf-8">Valid UTF-8</a></li>
      <li><a href="#unique-names">Unique names</a></li>
      <li><a href="#reference-memory-mapped-data">Reference memory-mapped data</a></li>
      <li><a href="#reference-substrings-of-other-objects">Reference substrings of other objects</a></li>
      <li><a href="#better-printing">Better printing</a></li>
      <li><a href="#conversion-to-character">Conversion to character</a></li>
      <li><a href="#interface-with-quanteda">Interface with <em>quanteda</em></a></li>
      <li><a href="#interface-with-tm">Interface with <em>tm</em></a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Leslie Huang, Patrick O. Perry.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>JSON Data Input — read_ndjson • corpus</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="JSON Data Input — read_ndjson" />
<meta property="og:description" content="Read data from a file in newline-delimited JavaScript Object Notation
    (NDJSON) format." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-4636081-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-4636081-3');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">corpus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/corpus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/chinese.html">Chinese text handling</a>
    </li>
    <li>
      <a href="../articles/gender.html">Finding gendered words</a>
    </li>
    <li>
      <a href="../articles/stemmer.html">Stemming Words</a>
    </li>
    <li>
      <a href="../articles/textdata.html">Text data in Corpus and other packages</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/leslie-huang/r-corpus/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>JSON Data Input</h1>
    
    <div class="hidden name"><code>read_ndjson.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Read data from a file in newline-delimited JavaScript Object Notation
    (NDJSON) format.</p>
    </div>

    <pre class="usage"><span class='fu'>read_ndjson</span><span class='op'>(</span><span class='va'>file</span>, mmap <span class='op'>=</span> <span class='cn'>FALSE</span>, simplify <span class='op'>=</span> <span class='cn'>TRUE</span>, text <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>file</th>
      <td><p>the name of the file which the data are to be read from,
        or a connection (unless <code>mmap</code> is <code>TRUE</code>, see below).
        The data should be encoded as UTF-8, and each line should be a
        valid JSON value.</p></td>
    </tr>
    <tr>
      <th>mmap</th>
      <td><p>whether to memory-map the file instead of reading all
        of its data into memory simultaneously. See the
        &#8216;Memory mapping&#8217; section.</p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>whether to attempt to simplify the type of the return
       value. For example, if each line of the file stores an integer,
       if <code>simplify</code> is set to <code>TRUE</code> then the return value
       will be an integer vector rather than a <code>corpus_json</code> object.</p></td>
    </tr>
    <tr>
      <th>text</th>
      <td><p>a character vector of string fields to interpret as
       <code>text</code> instead of <code>character</code>, or <code>NULL</code> to
       interpret all strings as <code>character</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is the recommended means of reading data for processing
    by the corpus package.</p>
<p>When the <code>text</code> argument is non-<code>NULL</code> string data
    fields with names indicated by this argument are decoded as
    <code>text</code> values, not as <code>character</code> values.</p>
    <h2 class="hasAnchor" id="memory-mapping"><a class="anchor" href="#memory-mapping"></a>Memory mapping</h2>

    <p>When you specify <code>mmap = TRUE</code>, the function memory-maps the file
    instead of reading it into memory directly. In this case, the <code>file</code>
    argument must be a character string giving the path to the file, not
    a connection object. When you memory-map the file, the operating
    system reads data into memory only when it is needed, enabling
    you to transparently process large data sets that do not fit into
    memory.</p>
<p>In terms of memory usage, enabling <code>mmap = TRUE</code> reduces the
    footprint for <code>corpus_json</code> and <code>corpus_text</code> objects;
    native R objects (<code>character</code>, <code>integer</code>, <code>list</code>,
    <code>logical</code>, and <code>numeric</code>) get fully deserialized to
    memory and produce identical results regardless of whether
    <code>mmap</code> is <code>TRUE</code> or <code>FALSE</code>. To process a large
    text corpus with a text field named <code>"text"</code>, you should set
    <code>text = "text"</code> and <code>mmap = TRUE</code>. Or, to reduce the memory
    footprint even further, set <code>simplify = FALSE</code> and
    <code>mmap = TRUE</code>.</p>
<p>One danger in memory-mapping is that if you delete the file
    after calling <code>read_ndjson</code> but before processing the data, then
    the results will be undefined, and your computer may crash. (On
    POSIX-compliant systems like Mac OS and Linux, there should be no
    ill effects to deleting the file. On recent versions of Windows,
    the system will not allow you to delete the file as long as the data
    is active.)</p>
<p>Another danger in memory-mapping is that if you serialize a
    <code>corpus_json</code> object or derived <code>corpus_text</code> object using
    <code><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></code> or another similar function, and then you
    deserialize the object, R will attempt create a new memory-map
    using the <code>file</code> argument passed to the original <code>read_ndjson</code>
    call. If <code>file</code> is a relative path, then your working directory
    at the time of deserialization must agree with your working directory
    at the time of the <code>read_ndjson</code> call.  You can avoid this
    situation by specifying an absolute path as the <code>file</code> argument
    (the <code><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></code> function will convert a relative
    to an absolute path).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>In the default usage, with argument <code>simplify = TRUE</code>, when
    the lines of the file are records (JSON object literals), the
    return value from <code>read_ndjson</code> is a data frame with class
    <code><a href='https://rdrr.io/r/base/c.html'>c("corpus_frame", "data.frame")</a></code>. With <code>simplify = FALSE</code>,
    the result is a <code>corpus_json</code> object.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='corpus_text.html'>as_corpus_text</a></code>, <code>as_utf8</code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Memory mapping</span>
<span class='va'>lines</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'{ "a": 1, "b": true }'</span>,
           <span class='st'>'{ "b": false, "nested": { "c": 100, "d": false }}'</span>,
           <span class='st'>'{ "a": 3.14, "nested": { "d": true }}'</span><span class='op'>)</span>
<span class='va'>file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/writeLines.html'>writeLines</a></span><span class='op'>(</span><span class='va'>lines</span>, <span class='va'>file</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'>read_ndjson</span><span class='op'>(</span><span class='va'>file</span>, mmap <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      a     b nested.c nested.d
#&gt; 1 1.00  TRUE       NA       NA
#&gt; 2   NA FALSE      100    FALSE
#&gt; 3 3.14    NA       NA     TRUE</div><div class='input'>
<span class='va'>data</span><span class='op'>$</span><span class='va'>a</span>
</div><div class='output co'>#&gt; [1] 1.00   NA 3.14</div><div class='input'><span class='va'>data</span><span class='op'>$</span><span class='va'>b</span>
</div><div class='output co'>#&gt; [1]  TRUE FALSE    NA</div><div class='input'><span class='va'>data</span><span class='op'>$</span><span class='va'>nested.c</span>
</div><div class='output co'>#&gt; [1]  NA 100  NA</div><div class='input'><span class='va'>data</span><span class='op'>$</span><span class='va'>nested.d</span>
</div><div class='output co'>#&gt; [1]    NA FALSE  TRUE</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='st'>"data"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># force the garbage collector to release the memory-map</span>
<span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.remove</a></span><span class='op'>(</span><span class='va'>file</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Leslie Huang, Patrick O. Perry.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


